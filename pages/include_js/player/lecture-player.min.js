window.location&&window.location.origin&&-1===window.location.origin.indexOf("192.168.1.114");var APP_URL_BACK=APP_URL+"adm/",APP_UNI="?&uni="+UNI;String.prototype.toHHMMSS=function(e,t){var i=parseInt(this,10),a=Math.floor(i/3600),n=Math.floor((i-3600*a)/60),o=i-3600*a-60*n;10>a&&(a=t?"0"+a:a),10>n&&(n=t?"0"+n:n),10>o&&(o="0"+o);var s;return s=e?n+":"+o:0===parseInt(a)?n+":"+o:a+":"+n+":"+o},function(e){$.fn.attrs=function(){if(0===arguments.length){if(0===this.length)return null;var t=[];return $.each(this[0].attributes,function(){this.specified&&t.push(this.name+'="'+this.value+'" ')}),t.join("")}return e.apply(this,arguments)}}($.fn.attrs);var hmsToSeconds=function(e){var t,i=e.split(":");return t=3===i.length?60*+i[0]*60+60*+i[1]+ +i[2]:2===i.length?60*+i[0]+ +i[1]:0},getColorForPercentage=function(e){var t;return t=.25>=e?"#DE330A":e>.25&&.5>=e?"#DEA10A":e>.5&&.9>=e?"#969C06":"#008000"};$.widget("ui.durationspinner",$.ui.spinner,{options:{step:1,stop:function(e,t){var i=$(e.target);i.hasClass("annotation-startime")?$(document).trigger("spinnerTimeStart",i):$(document).trigger("spinnerTimeEnd",i)}},_parse:function(e){return"string"==typeof e?hmsToSeconds(e):e},_format:function(e){var t=e+"";return t.toHHMMSS(!0)}}),JSON.smartParse=function(e){try{if("object"==typeof e)return e;var t=JSON.parse(e);return t}catch(i){console.error(" JSON IS NOT VALID ",i)}},EW.presentation_json_data={dependencies:["videojs","jsrender","highlightjs"],data:{},activeSlideIndex:1,allSlides:5,layoutManagerReady:!1,dataPublishedOnce:!1,init:function(e){var t=this;(new Date).getTime();if(!jsonuri)return void console.error("Please provide an url for presentation data");try{EW.presentation_layout_manager.setConfig({fn:function(i){t.getJson(e,i)}})}catch(i){t.getJson(e,{}),console.log("presentation_layout_manager error",i)}$(document).off("reinit").on("reinit",function(e,i){i&&(t.activeSlideIndex=i.index),t.init()}),$(document).off("reinit.reference").on("reinit.reference",function(e,i){i&&(t.activeSlideIndex=i.index),"reference"==e.namespace&&t.init("reference")}),$(document).off("reinit.navigation").on("reinit.navigation",function(e,i){i&&(t.activeSlideIndex=i.index),"navigation"==e.namespace&&t.init("navigation")}),$(document).off("reinit.player").on("reinit.player",function(e,i){i&&(t.activeSlideIndex=i.index),"player"===e.namespace&&t.init("player")}),$(document).off("reinit.transcript").on("reinit.transcript",function(e,i){i&&(t.activeSlideIndex=i.index),"transcript"==e.namespace&&t.init("transcript")}),$(document).off("reinit.author").on("reinit.author",function(e,i){i&&(t.activeSlideIndex=i.index),"author"==e.namespace&&t.init("author")}),$(document).off("getPresentationJson").on("getPresentationJson",function(e,i){i(t.data)}),$(document).off("postPresentationJson").on("postPresentationJson",function(e,i){t.data=i})},getJson:function(e,t){var i=this;$.ajax({url:jsonuri+"&tmstm="+Math.floor(1e3*Math.random()),success:function(a){if("object"==typeof a){if(a.slides&&0===a.slides.length)return;i.publishJson(a,e,t)}else try{var n=JSON.smartParse(a);if("object"==typeof n){if(n.slides&&0===n.slides.length)return;i.publishJson(n,e,t)}else console.error(" JSON IS NOT VALID ")}catch(o){console.error(" JSON IS NOT VALID ")}},error:function(e){console.error(e)},complete:function(){}})},publishJson:function(e,t,i){window.top&&-1!==window.top.location.href.indexOf("durationchange")&&(e.durationCalculated=0),this.data=e,t&&"reference"===t?$(document).trigger("jsonPublished."+t,[this.data,i]):t&&"navigation"===t?$(document).trigger("jsonPublished."+t,[this.data,i]):t&&"player"===t?$(document).trigger("jsonPublished."+t,[this.data,i]):t&&"author"===t?$(document).trigger("jsonPublished."+t,[this.data,i]):t&&"transcript"===t?$(document).trigger("jsonPublished."+t,[this.data,i]):$(document).trigger("jsonPublished",[this.data,i]),"author"!==t&&$(document).trigger("slideChange",this.data.slides["slide_"+this.activeSlideIndex])}},EW.presentation_resize={virtualClass:"virtual_slides",fullscreenClass:"presentation_fullscreen",isFullscreen:!1,init:function(){var e=this,t=$("#presentation"),i=$("#LectureContainer"),a=$(".presentation-outer-container");this.bodyDom=$("body"),$(document).on("jsonPublished",function(t,i,a){i.has_virtual_slides===!0&&"undefined"==typeof i.internal_virtual?e.hasVirtualSlides=!0:i.has_virtual_slides===!1&&"undefined"==typeof i.internal_virtual?e.hasVirtualSlides=!1:e.hasVirtualSlidesInternal=!0}),$(window).on("resize lectureContentWrapperDimensionsChanged",function(){e.resizeHandler(i,a,t,!0)}),$(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(n){var o=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.MSFullscreenChange,s=o?"on":"off";"on"===s?(e.bodyDom.hasClass(e.fullscreenClass)||e.bodyDom.addClass(e.fullscreenClass),e.isFullscreen=!0):(e.bodyDom.hasClass(e.fullscreenClass)&&e.bodyDom.removeClass(e.fullscreenClass),e.isFullscreen=!1),e.resizeHandler(i,a,t)}),$(document).on("navTplAdded layoutManagerReady",function(){e.resizeHandler(i,a,t,!0)})},resizeHandler:function(e,t,i,a){var n=this;if(this.isDesktop=e.length?e.outerWidth(!0)>767:t.outerWidth(!0)>767,$(document).off("isDesktop").on("isDesktop",function(e,t){t(n.isDesktop)}),this.hasVirtualSlides||(this.hasVirtualSlides=n.bodyDom.hasClass(n.virtualClass)),this.isDesktop&&this.isFullscreen)clearTimeout(this.fullscreenTime),this.fullscreenTime=setTimeout(function(){if(i.css({width:"auto",height:"auto"}),i.height()>window.innerHeight-60){var e=i.width()*((window.innerHeight-60)/i.height());i.css("width",e)}},a?0:700);else if(this.isDesktop&&!this.isFullscreen)i.css({width:"auto",height:"auto"});else if(this.isDesktop===!1&&this.hasVirtualSlides===!0)console.log(" not desktop and virtual slides ");else{var o=$("#presentationNavigation"),s=o.find("li").length,r=o.parents(".presentation_separate_virtualslides").length?110:74;o.width(r*s)}}},EW.presentation_player={containerSelector:"#presentationPlayer",templateSelector:"#presentationPlayerTemplate",noChangeModeClass:"slide_no_changemode",fullscreenClass:"presentation_fullscreen",playerContainerDom:{},containerDom:{},slideIndex:1,slideId:null,dataSlidesCount:0,playerMode:"video",videoExtraDelay:0,audioRtmpEnabled:!1,hasVirtualSlides:!1,hasVirtualSlidesInternal:void 0,dataSlides:{},init:function(){this.containerDom=$(this.containerSelector),this.playerContainer=$("#presentationPlayerContainer"),this.handleEvents(),this.initPlayer(),(bowser.mobile||bowser.tablet)&&this.containerDom.addClass("disable-fullscreen")},hasNext:function(){var e=this.hasVirtualSlidesInternal?"virtualSlides":"dataSlides";return"undefined"!=typeof this[e]["slide_"+(this.slideIndex+1)]?!0:!1},slideNext:function(){this.hasNext()?(this.slideIndex=this.slideIndex+1,this.hasVirtualSlides===!1?$(document).trigger("slideChange",this.dataSlides["slide_"+this.slideIndex]):$(document).trigger("virtualSlideChange",this.virtualSlides["slide_"+this.slideIndex])):this.hasVirtualSlides===!1?$(document).trigger("lastSlideActive",this.dataSlides["slide_"+this.slideIndex]):$(document).trigger("virtualSlideChange",this.virtualSlides["slide_"+this.slideIndex])},slidePrev:function(){var e=this.hasVirtualSlidesInternal?"virtualSlides":"dataSlides";"undefined"!=typeof this[e]["slide_"+(this.slideIndex-1)]?(this.slideIndex=this.slideIndex-1,this.hasVirtualSlides===!1?$(document).trigger("slideChange",this.dataSlides["slide_"+this.slideIndex]):$(document).trigger("virtualSlideChange",this.virtualSlides["slide_"+this.slideIndex])):this.hasVirtualSlides===!1?$(document).trigger("firstSlideActive",this.dataSlides["slide_"+this.slideIndex]):$(document).trigger("virtualSlideChange",this.virtualSlides["slide_"+this.slideIndex])},initPlayer:function(){var e=this;$(document).on("videoTplAdded",function(){function t(t){clearTimeout(n),n=setTimeout(function(){a=e.videoPlayer.duration()},500),(e.hasVirtualSlides||e.hasVirtualSlidesInternal)&&$(document).trigger("videoPlayerInited"),e.playerEditMode&&e.playerEditMode===!0&&t!==!1&&$(document).trigger("slidePause")}e.addControlItems();var i="slide_video";e.videoPlayer=videojs(i,{plugins:{firstbtn:{},prevbtn:{},nextbtn:{},lastbtn:{},fullscreenBtn:{},settingBtn:{},audioplayerBtn:{},videoplayerBtn:{},volumetoggleBtn:{},searchslidesBtn:{},restartBtn:{},gotoendBtn:{}}},function(){this.progressTips()}),e.videoPlayer.ready(function(){e.controlbarEvents(),e.sessionEvents();var t=$('video[id*="slide_video"]');enableInlineVideo(t[0]),t.addClass("IIV")}),e.videoPlayer.persistvolume({namespace:"Virality-Is-Reality"});var a,n;e.videoPlayer.one("play",function(){if(e.hasVirtualSlides===!1){var i=e.dataSlides["slide_"+e.slideIndex];i.video.mp4||i.video.webm||$(document).trigger("slideChange",i)}t(!1),setTimeout(function(){e.videoPlayer.on("firstplay",t)},200)});var o;$(document).on("slideChange",function(t,i){clearTimeout(e.vEndTimer),clearInterval(o)});e.containerDom.find(".vjs-current-time-display"),e.containerDom.find(".vjs-duration-display");e.videoDurationExtra();e.videoPlayer.on("timeupdate",function(){var t=e.videoPlayer.currentTime();e.videoPlayer.paused()?($(document).trigger("videoTimeUpdate.annoedit",t),$(document).trigger("videoTimeUpdate.annoprev",t)):$(document).trigger("videoTimeUpdate",t)}),$(document).on("getPlayer",function(t,i){i(e.videoPlayer)}),e.playerContainer.find("video").on("loadedmetadata",function(){try{var t=e.dataSlides["slide_"+e.slideIndex];"video"===e.playerMode&&(t.video&&t.video.mp4&&t.video.mp4.url&&""!==t.video.mp4.url||t.video&&t.video.webm&&t.video.webm.url&&""!==t.video.webm.url)&&e.containerDom.find("video").attr("poster","")}catch(i){console.error(i)}$(document).trigger("loadedMetadata",e.videoPlayer)})}),$("#editPlayerItemSave").on("click",function(t,i){$(document).trigger("reinit.player",e.dataSlides["slide_"+e.slideIndex]),$(document).trigger("reinit.navigation",e.dataSlides["slide_"+e.slideIndex])})},getDurationExtra:function(){var e;return e=this.dataSlides["slide_"+this.slideIndex].durationExtra?1e3*Number(this.dataSlides["slide_"+this.slideIndex].durationExtra):this.videoExtraDelay},videoDurationExtra:function(){var e=this,t=e.getDurationExtra();e.videoPlayer.on("ended",function(){if("undefined"!=typeof t&&t>=0){if(e.hasVirtualSlides||e.hasVirtualSlidesInternal)return;("undefined"==typeof e.playerEditMode||e.playerEditMode===!1)&&(clearTimeout(e.vEndTimer),e.vEndTimer=setTimeout(function(){e.slideNext()},t))}});var i,a,n,o;e.videoPlayer.on("loadedmetadata",function(){t=e.getDurationExtra(),"undefined"!=typeof t&&t>=0||(i=e.videoPlayer.duration(),a=t/1e3,n=i+a,o=Math.floor(n),e.hasVirtualSlides||e.hasVirtualSlidesInternal||e.videoPlayer.duration(n))}),e.videoPlayer.on("timeupdate",function(){if(!("undefined"!=typeof t&&t>=0||e.videoPlayer.paused())){var i=e.videoPlayer.currentTime(),a=Math.floor(i);o===a&&(e.hasNext()?e.slideNext():(e.videoPlayer.pause(),e.videoPlayer.currentTime(0),e.videoPlayer.posterImage.show(),e.videoPlayer.bigPlayButton.show()))}})},addControlItems:function(){videojs.nextBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.prevBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.firstBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.lastBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.fullscreenBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.settingBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.audioplayerBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.videoplayerBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.volumetoggleBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.searchslidesBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.restartBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}}),videojs.gotoendBtn=videojs.Button.extend({init:function(e,t){videojs.Button.call(this,e,t),this.on("click",this.onClick)}});var e,t=function(e,t){var i={className:"vjs-"+e+"-button vjs-control",innerHTML:'<div class="vjs-control-content" title="'+t+'"><span class="vjs-control-text">'+e+"Btn</span></div>",role:"button","aria-live":"polite",tabIndex:0};return videojs.Component.prototype.createEl(null,i)};videojs.plugin("nextbtn",function(){var i={el:t("next","Next slide")};e=new videojs.nextBtn(this,i),this.controlBar.el().appendChild(e.el())});var i;videojs.plugin("prevbtn",function(){var e={el:t("prev","Previous slide")};i=new videojs.prevBtn(this,e),this.controlBar.el().appendChild(i.el())});var a;videojs.plugin("firstbtn",function(){var e={el:t("first","First slide")};a=new videojs.firstBtn(this,e),this.controlBar.el().appendChild(a.el())});var n;videojs.plugin("lastbtn",function(){var e={el:t("last","Last slide")};n=new videojs.lastBtn(this,e),this.controlBar.el().appendChild(n.el())});var o;videojs.plugin("fullscreenBtn",function(){var e={el:t("fullscreen","Fullscreen")};o=new videojs.fullscreenBtn(this,e),this.controlBar.el().appendChild(o.el())});var s;videojs.plugin("settingBtn",function(){var e={el:t("setting","Settings")};s=new videojs.settingBtn(this,e),this.controlBar.el().appendChild(s.el())});var r;videojs.plugin("audioplayerBtn",function(){var e={el:t("audioplayer","Image mode")};r=new videojs.audioplayerBtn(this,e),this.controlBar.el().appendChild(r.el())});var l;videojs.plugin("videoplayerBtn",function(){var e={el:t("videoplayer","Video mode")};l=new videojs.videoplayerBtn(this,e),this.controlBar.el().appendChild(l.el())});var d;videojs.plugin("volumetoggleBtn",function(){var e={el:t("volumetoggle","Volume")};d=new videojs.volumetoggleBtn(this,e),this.controlBar.el().appendChild(d.el())});var c;videojs.plugin("searchslidesBtn",function(){var e={el:t("searchslides","Search slides")};c=new videojs.searchslidesBtn(this,e),this.controlBar.el().appendChild(c.el())});var u;videojs.plugin("restartBtn",function(){var e={el:t("restart","Go to start")};u=new videojs.restartBtn(this,e),this.controlBar.el().appendChild(u.el())});var g;videojs.plugin("gotoendBtn",function(){var e={el:t("gotoend","Go to end")};g=new videojs.gotoendBtn(this,e),this.controlBar.el().appendChild(g.el())}),videojs.nextBtn.prototype.onClick=function(){},videojs.prevBtn.prototype.onClick=function(){},videojs.firstBtn.prototype.onClick=function(){},videojs.lastBtn.prototype.onClick=function(){},videojs.fullscreenBtn.prototype.onClick=function(){},videojs.settingBtn.prototype.onClick=function(){},videojs.audioplayerBtn.prototype.onClick=function(){},videojs.videoplayerBtn.prototype.onClick=function(){},videojs.volumetoggleBtn.prototype.onClick=function(){},videojs.searchslidesBtn.prototype.onClick=function(){},videojs.restartBtn.prototype.onClick=function(){},videojs.gotoendBtn.prototype.onClick=function(){}},controlbarEvents:function(){function e(e,t){var a=i.containerDom.find(e);a.on("click.control touchstart.control",function(e){t(),e.stopPropagation()})}var t,i=this;e(".vjs-next-button",function(){clearTimeout(t),t=setTimeout(function(){i.slideStatus().isLast===!1&&i.slideNext()},500)}),e(".vjs-prev-button",function(){clearTimeout(t),t=setTimeout(function(){i.slideStatus().isFirst===!1&&i.slidePrev()},500)}),e(".vjs-first-button",function(){i.slideStatus().isFirst===!1&&(i.slideIndex=1,i.hasVirtualSlides===!1?$(document).trigger("slideChange",i.dataSlides.slide_1):$(document).trigger("virtualSlideChange",i.virtualSlides.slide_1))}),e(".vjs-last-button",function(){i.slideStatus().isLast===!1&&(i.slideIndex=i.dataSlidesCount,i.hasVirtualSlides===!1?$(document).trigger("slideChange",i.dataSlides["slide_"+i.dataSlidesCount]):$(document).trigger("virtualSlideChange",i.virtualSlides["slide_"+i.dataSlidesCount]))}),e(".vjs-fullscreen-button",function(){$(document).trigger("isDesktop",function(e){var t=e?".presentation-outer-container":".presentation-outer-container video";i.goFullscreen($(t)[0])})}),e(".vjs-setting-button",function(){i.settings()}),e(".vjs-audioplayer-button",function(){i.changeModeAudioBtn||(i.changeModeAudioBtn=$(".vjs-audioplayer-button")),$(document).trigger("playerModeChange",{canchange:!i.changeModeAudioBtn.hasClass("disabled")})}),e(".vjs-videoplayer-button",function(){i.changeModeVideoBtn||(i.changeModeVideoBtn=$(".vjs-videoplayer-button")),$(document).trigger("playerModeChange",{canchange:!i.changeModeVideoBtn.hasClass("disabled")})}),e(".vjs-volumetoggle-button",function(){i.containerDom.toggleClass("volume_bar_mobile")}),e(".vjs-searchslides-button",function(){$(document).trigger("slidesSearchMobile")}),e(".vjs-restart-button",function(){i.videoPlayer.currentTime(0)}),e(".vjs-gotoend-button",function(){var e=i.dataSlides["slide_"+i.slideIndex].durationCalculated;e=parseFloat(e);var t=i.videoPlayer.duration(),a=t||e;i.videoPlayer.currentTime(a-2)})},settings:function(){this.playerSettingsDom||(this.playerSettingsDom=$("#presentationPlayerSettings")),this.settingsShown===!0?(this.playerSettingsDom.hide(),this.settingsShown=!1):(this.playerSettingsDom.show(),this.settingsShown=!0)},handleEvents:function(){var e=this;$(document).on("jsonPublished.player",function(t,i){if(i.has_virtual_slides===!0&&"undefined"==typeof i.internal_virtual?e.hasVirtualSlides=!0:i.has_virtual_slides===!1&&"undefined"==typeof i.internal_virtual?e.hasVirtualSlides=!1:(e.hasVirtualSlides=void 0,e.hasVirtualSlidesInternal=!0),e.hasVirtualSlides){e.virtualJson=i;var a=$("body");a.hasClass("virtual_slides")||a.addClass("virtual_slides")}e.hasVirtualSlidesInternal?e.virtualSlides=i.virtual_slides:e.virtualSlides=i.slides,e.dataSlidesCount=0;for(var n in e.virtualSlides)e.dataSlidesCount=e.dataSlidesCount+1;e.dataSlides=i.slides}),$(document).on("slideChange",function(t,i){e.hasVirtualSlides!==!0?(e.slideIndex=parseInt(i.index),e.slideId=parseInt(i.slide_id),e.videoPlayer?(e.setMediaMode(i),i.video_start_time&&""!==i.video_start_time&&e.videoPlayer.currentTime(parseInt(i.video_start_time)),e.videoPlayer.play()):e.templating(i),e.slideStatus(!0),setTimeout(function(){$(document).trigger("videoDuration",e.videoPlayer.duration())},1e3),e.replaceEditUrl(),e.playerModeAction(e.playerMode)):e.virtualSlidesHandle()}),$(document).on("virtualSlideChange",function(t,i){i&&i.start_time&&e.videoPlayer.currentTime(i.start_time),e.slideIndex=i.index,e.slideStatus()}),$(document).on("virtualSlideChange.navigation",function(t,i){e.slideIndex=i.index,e.slideStatus(!0)}),$(document).on("playerModeChange",function(t,i){if(!i||"undefined"==typeof i.canchange||i.canchange!==!1){e.playerModeAction(e.playerMode);var a=e.videoPlayer.currentTime();"video"===e.playerMode?(e.playerMode="audio",e.containerDom.addClass("audio_mode"),e.setMediaMode(e.dataSlides["slide_"+e.slideIndex],a,!0)):(e.playerMode="video",e.containerDom.removeClass("audio_mode"),e.setMediaMode(e.dataSlides["slide_"+e.slideIndex],a,!0))}}),$(document).on("slidePause",function(){e.videoPlayer.paused()||e.videoPlayer.pause()}),$(document).on("slidePlay",function(){e.videoPlayer.paused()&&e.videoPlayer.play()}),$(document).on("subtitlesTimeUpdate",function(t,i){"undefined"!=typeof i&&e.videoPlayer.currentTime(i)}),$(document).on("annotationsTimeUpdate",function(t,i){i&&e.videoPlayer.currentTime(i)});var t;$(document).on("slideChangeStatus",function(i,a){t||(t=e.containerDom.find(".vjs-control-bar")),t.find(">*").removeClass("disabled"),a.isFirst===!0&&t.find(".vjs-prev-button,.vjs-first-button").addClass("disabled"),a.isLast===!0&&t.find(".vjs-next-button,.vjs-last-button").addClass("disabled")}),$(document).on("player_editmode",function(t,i){i.mode?(e.playerEditMode=!0,e.playerContainer.addClass("editmode_player")):(e.playerEditMode=!1,e.playerContainer.removeClass("editmode_player"))})},virtualSlidesHandle:function(){var e=this;e.templating(e.virtualJson)},replaceEditUrl:function(){try{if(this.regexEditDataUrl||(this.regexEditDataUrl=this.containerDom.find(".editmode_player_edit").attr("data-url")),this.regexEditDataUrl){var e=this.regexEditDataUrl.replace(/\{slide_id\}/g,this.slideId);this.containerDom.find(".editmode_player_edit").attr("data-url",e)}}catch(t){console.error(t)}},playerModeAction:function(e){var t=this.dataSlides["slide_"+this.slideIndex];this.changeModeVideoBtn&&0!==this.changeModeVideoBtn.length||(this.changeModeVideoBtn=$(".vjs-videoplayer-button")),this.changeModeAudioBtn&&0!==this.changeModeAudioBtn.length||(this.changeModeAudioBtn=$(".vjs-audioplayer-button")),this.changeModeAudioBtn.removeClass("disabled"),this.changeModeVideoBtn.removeClass("disabled"),"video"===e?t&&!t.big_img&&(this.changeModeAudioBtn.addClass("disabled"),$(document).trigger("playerModeChange",{canchange:!1})):t.video.mp4&&(t.video.mp4.url||t.video.webm.url)||(this.changeModeVideoBtn.addClass("disabled"),this.containerDom.addClass("audio_mode"),$(document).trigger("playerModeChange",{canchange:!1}))},setMediaMode:function(){var e=arguments[0],t=!0;t=(e.video.mp4&&e.video.mp4.url&&""!==e.video.mp4.url||e.video.webm&&e.video.webm.url&&""!==e.video.webm.url)&&e.audio.mp3&&e.audio.mp3.url&&""!==e.audio.mp3.url?!0:!1,t?this.playerContainer.removeClass(this.noChangeModeClass):this.playerContainer.addClass(this.noChangeModeClass),"video"===this.playerMode?this.setVideo.apply(this,arguments):this.setAudio.apply(this,arguments)},setVideo:function(e,t,i){var a=this;if(this.posterDom||(this.posterDom=$(".vjs-poster")),e.video.mp4&&e.video.mp4.url&&""!==e.video.mp4.url&&e.video.webm&&e.video.webm.url&&""!==e.video.webm.url)try{this.videoPlayer.src([{type:e.video.mp4.type,src:STREAMING_URL+e.video.mp4.url+APP_UNI+"&stamp="+(new Date).getTime()},{type:e.video.webm.type,src:VIDEO_FILE_URL_RC+e.video.webm.url+APP_UNI+"&stamp="+(new Date).getTime()}]),this.playerEditMode!==!0?this.videoPlayer.play():(this.videoPlayer.play(),this.videoPlayer.pause()),this.videoPlayer.duration(parseInt(e.durationCalculated)+parseInt(e.durationExtra))}catch(n){console.error(n)}else if(e.video.mp4&&e.video.mp4.url&&""!==e.video.mp4.url)try{this.videoPlayer.src({type:e.video.mp4.type,src:STREAMING_URL+e.video.mp4.url+APP_UNI+"&stamp="+(new Date).getTime()}),this.playerEditMode!==!0?this.videoPlayer.play():setTimeout(function(){a.videoPlayer.play(),a.videoPlayer.pause()},400),this.videoPlayer.duration(parseInt(e.durationCalculated)+parseInt(e.durationExtra))}catch(n){console.error(n)}else if(e.video.webm&&e.video.webm.url&&""!==e.video.webm.url)try{this.videoPlayer.src({type:e.video.webm.type,src:VIDEO_FILE_URL_RC+e.video.webm.url+APP_UNI+"&stamp="+(new Date).getTime()}),this.playerEditMode!==!0?this.videoPlayer.play():(this.videoPlayer.play(),this.videoPlayer.pause()),this.videoPlayer.duration(parseInt(e.durationCalculated)+parseInt(e.durationExtra))}catch(n){console.error(n)}else console.error("NO VIDEO AVAILABLE => REDIRECT TO AUDIO"),this.setAudio(e);if(t&&this.videoPlayer.currentTime(t),i){var o="Video mode activated",s="";$(document).trigger("smart-notification",{title:o,content:s,type:"success"})}},setAudio:function(e,t,i){if(this.posterDom||(this.posterDom=$(".vjs-poster")),e.audio.mp3&&e.audio.mp3.url&&""!==e.audio.mp3.url)try{this.videoPlayer.src(this.audioRtmpEnabled?{type:e.audio.mp3.type,src:STREAMING_URL+e.audio.mp3.url+APP_UNI+"&stamp="+(new Date).getTime()}:{type:"audio/mp3",src:APP_URL+e.audio.mp3.url+APP_UNI+"&stamp="+(new Date).getTime()}),$("video").attr("poster",APP_URL+e.big_img),this.posterDom.hide(),e.big_img?this.containerDom.find("video").attr("poster","").attr("poster",APP_URL+e.big_img+APP_UNI+"&stamp="+(new Date).getTime()):this.posterDom.css("background-image","url("+APP_URL+e.big_img+APP_UNI+"&stamp="+(new Date).getTime()+")").show(),this.playerEditMode!==!0?this.videoPlayer.play():(this.videoPlayer.play(),this.videoPlayer.pause());try{this.videoPlayer.duration(parseInt(e.durationCalculated)+parseInt(e.durationExtra))}catch(a){console.error(a)}}catch(a){console.error("audio error")}else{this.videoPlayer.src({type:"audio/mp3",src:APP_URL+"include_js/player/point1sec.mp3"}),this.posterDom.hide(),e.big_img&&this.containerDom.find("video").attr("poster","").attr("poster",APP_URL+e.big_img+APP_UNI+"&stamp="+(new Date).getTime()),this.playerEditMode!==!0?this.videoPlayer.play():(this.videoPlayer.play(),this.videoPlayer.pause());try{var n=parseInt(e.durationExtra)>=0?parseInt(e.durationExtra):0;this.videoPlayer.duration(n)}catch(a){console.error(a)}}if(t&&this.videoPlayer.currentTime(t),i){var o="Image mode activated",s=" ";$(document).trigger("smart-notification",{title:o,content:s,type:"success"})}},goFullscreen:function(e){var t=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.MSFullscreenChange;if(this.bodyDom||(this.bodyDom=$("body")),screenfull.enabled!==!0){var i="simulate-fullscreen";$("body").toggleClass(i),$("body").hasClass(i)||$(window).scrollTop(0)}else if(t)try{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}catch(a){console.error(a)}else try{e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}catch(a){console.error(a)}},templating:function(e){var t=this;try{var i=$.templates(this.templateSelector),a=t.slideConfigCheck(e),n=i.render(a);this.containerDom.html(n)}catch(o){console.error(o)}$(document).trigger("videoTplAdded")},slideConfigCheck:function(e){return-1===e.big_img.indexOf("http")&&(e.big_img=APP_URL+e.big_img),!$.trim(e.big_img)&&presentationConfig.player.extra.coverImage&&-1!==presentationConfig.player.extra.coverImage.indexOf("http")&&(e.big_img=presentationConfig.player.extra.coverImage),e},slideStatus:function(e){var t={};return t.currentNr=this.slideIndex,t.allNr=this.dataSlidesCount,t.isFirst=1===t.currentNr?!0:!1,t.isLast=t.currentNr===t.allNr?!0:!1,t.isBetween=t.isFirst===!1&&t.isLast===!1?!0:!1,e&&setTimeout(function(){$(document).trigger("slideChangeStatus",t)},400),t},sessionEvents:function(){var e=this,t=5;e.videoPlayer.one("play",function(){$(document).trigger("presentation.playing")});var i;e.videoPlayer.on("timeupdate",function(){if(!e.videoPlayer.paused()){var a=e.videoPlayer.currentTime(),n=Math.ceil(a);n&&n!=i&&n%t===0&&(i=n,$(document).trigger("presentation.playing"))}}),$(document).on("slideChange",function(){$(document).trigger("presentation.slidechange")})}},EW.presentation_annotations={annotationSelector:".annotation",annotationCloseSelector:".annotation-close",playerContainerDom:{},annotationFlag:!0,userBasketPrefs:[],layoutStates:void 0,blockIfEmpty:!1,init:function(){this.handleEvents()},handleEvents:function(){var e=this;return this.playerContainerDom=$("#presentationPlayer"),EW.presentation_layout_manager.setConfig({fn:function(t){e.layoutStates=t}}),e.layoutStates.logicalStates&&-1===e.layoutStates.logicalStates.indexOf("annotationInit")?void console.log("Not initing annotation (based on config)"):($(document).on("jsonPublished",function(t,i){return e.layoutStates.logicalStates&&-1!==e.layoutStates.logicalStates.indexOf("annotationNotEmpty")&&i.annotationsEmpty===!0?(e.blockIfEmpty=!0,void EW.presentation_layout_manager.setConfig({config:{annotations:{show:"false"}}})):void 0}),$(document).on("slideChange.annotation",function(t,i){e.activeSlide=i,e.getUserPrefs(),e.blockIfEmpty||e.annotationFlag===!0&&(e.activeAnnotations=[],e.playerContainerDom.find(".annotation").each(function(){$(this).remove()}),e.slideAnnotations=[],e.getAnnotations(i.annotation))}),$(document).on("playerSettingsChange",function(t,i){"boolean"==typeof i.annotation&&(e.annotationFlag=i.annotation,e.annotationFlag?e.enableAnnotations():e.disableAnnotations()),i.editmodeplayer===!0?e.disableAnnotations():e.annotationFlag&&e.getAnnotations(e.activeSlide.annotation,function(){if(e.enableAnnotations(),e.videoPlayer){var t=e.videoPlayer.currentTime()||0;$(document).trigger("videoTimeUpdate.annoprev",t)}else $(document).trigger("getPlayer",function(t){e.videoPlayer=t;var i=e.videoPlayer.currentTime()||0;$(document).trigger("videoTimeUpdate.annoprev",i)})})}),$(document).on("click.annobasket",".annotation .reference-basket",function(){var e=$(this).attr("date-ned");e&&$(document).trigger("changedAnnotationBasket",{id:e,status:!0})}),$(document).on("changedReferenceBasket changedAnnotationBasket",function(e,t){var i="This item is alredy in your reading basket";t.title&&(i=t.title);var a='<a href="javascript:void(0);" class="reference-basket disabled" title="'+i+'"><i class="fa fa-bookmark disabled"></i></a>';$(".annotation .reference-basket").each(function(){$(this).attr("date-ned")===t.id&&$(this).replaceWith(a)})}),void this.enableAnnotations())},getUserPrefs:function(){var e=this;$(document).trigger("getUserPref",function(t){e.userBasketPrefs=t})},enableAnnotations:function(){var e=this;e.activeAnnotations=[],this.getUserPrefs(),$(document).off("videoTimeUpdate.annoprev").on("videoTimeUpdate.annoprev",function(t,i){e.slideAnnotations&&e.slideAnnotations.length&&e.annotationFlag!==!1&&e.addAnnotation(i)}),this.playerContainerDom.off("click.annotation").on("click.annotation",this.annotationCloseSelector,function(){e.closeAnnotation($(this))}),this.playerContainerDom.off("click.annoopen").on("click.annoopen",".annotation",function(){$(document).trigger("slidePause")})},disableAnnotations:function(){$(document).off("videoTimeUpdate.annotation"),$(document).off("videoTimeUpdate.annoprev"),this.playerContainerDom.off("click.annotation"),this.activeAnnotations=[],this.playerContainerDom.find(".annotation").each(function(){$(this).remove()})},closeAnnotation:function(e,t){t?t.remove():e.closest(this.annotationSelector).remove()},activeAnnotations:[],addAnnotation:function(e){function t(e,t){try{var i,n=e.attr("data-reference-id");if(i=a.userBasketPrefs["reference_"+n]&&"undefined"!=typeof a.userBasketPrefs["reference_"+n].toBasket?!a.userBasketPrefs["reference_"+n].toBasket:!0){var o='<a href="javascript:void(0);" class="reference-basket text-success save-fav" date-fav="in" date-ned="'+n+'" title="Add to the reading basket" data-title="The surgical approach to subaxial cervical spine injuries: an evidence-based algorithm based on the SLIC classification system."><i class="fa fa-bookmark"></i></a>';e.find(".reference-basket").replaceWith(o)}else{var s='<a href="javascript:void(0);" class="reference-basket disabled" title="Already in the reading basket" data-title="Spinal Disorders; Section Fractures; Chapter about subaxial CS Injuries."><i class="fa fa-bookmark disabled"></i></a>';e.find(".reference-basket").replaceWith(s)}return e.prop("outerHTML")}catch(r){return t}}var i,a=this,n=0;for(n;n<this.slideAnnotations.length;n++)if(-1===this.activeAnnotations.indexOf(n)&&this.slideAnnotations[n].startTime<=e&&e<=this.slideAnnotations[n].endTime){i='<span data-index="{index}" class="annotation-close" title="Close annotation" data-start-time="{start}"  data-end-time="{end}" class="txt-color-red pull-right"><i class="fa fa-lg fa-times"></i></span>';var o=$.parseHTML(this.slideAnnotations[n].text);i=i.replace(/\{index\}/g,n),i=i.replace(/\{start\}/g,this.slideAnnotations[n].startTime),i=i.replace(/\{end\}/g,this.slideAnnotations[n].endTime),this.activeAnnotations.push(n),$(o).append(i);var s;s=t($(o),o),this.playerContainerDom.append(s);
}var r=this.playerContainerDom.find(this.annotationSelector);r.each(function(){var t=$(this).find(".annotation-close");if(e>parseFloat(t.attr("data-end-time"))||e<parseFloat(t.attr("data-start-time"))){var i=a.activeAnnotations.indexOf(parseInt(t.attr("data-index")));a.activeAnnotations.splice(i,1),a.closeAnnotation(t,$(this))}})},getAnnotations:function(e,t){var i=this;e.json?$.ajax({url:APP_URL+e.json+"&tmstma="+Math.floor(1e3*Math.random()),cache:!1,success:function(e){try{i.slideAnnotations=e?JSON.smartParse(e):[],$(document).trigger("annotationReturned",{annotations:i.slideAnnotations}),t&&t()}catch(a){console.error(a)}}}):e.vtt&&""!==e.vtt?$.ajax({url:APP_URL+e.vtt+"?tmstm="+Math.floor(1e3*Math.random()),success:function(e){t?i.parseAnnotations(e,t):i.parseAnnotations(e)},error:function(e){console.error(e)}}):(i.slideAnnotations=[],$(document).trigger("annotationReturned",{annotations:i.slideAnnotations}),t&&t())},parseAnnotations:function(e,t){var i=this,a=1,n=[],o=new WebVTT.Parser(window,WebVTT.StringDecoder());o.oncue=function(e){var t={};t.text=e.text,e.id&&(t.id=e.id),t.index=a,t.startTime=e.startTime,t.endTime=e.endTime,a+=1,-1!==e.text.indexOf("annotation")&&n.push(e)},o.onflush=function(){i.slideAnnotations=n,$(document).trigger("annotationReturned",{annotations:i.slideAnnotations}),t&&t()},o.parse(e),o.flush()}},EW.presentation_transcript={containerSelector:"#presentationSubtitles",templateSelector:"#presentationSubtitlesTemplate",subtitleSelector:".subtitle",bodyDom:void 0,containerDom:{},dataSlide:{},subtitleFlag:!0,containerHeight:95,transcriptionEditMode:!1,highlightedIndex:0,layoutStates:void 0,blockIfEmpty:!1,init:function(){this.handleEvents()},handleEvents:function(){var e=this;if(this.containerDom=$(this.containerSelector),this.subtContainer=$("#presentationSubtitlesContainer"),EW.presentation_layout_manager.setConfig({fn:function(t){e.layoutStates=t}}),e.layoutStates.logicalStates&&-1===e.layoutStates.logicalStates.indexOf("transcriptionInit"))return void console.log("Not initing transcript (based on config)");$(document).on("jsonPublished",function(t,i){return e.layoutStates.logicalStates&&-1!==e.layoutStates.logicalStates.indexOf("transcriptionNotEmpty")&&i.transcriptionEmpty===!0?(e.blockIfEmpty=!0,void EW.presentation_layout_manager.setConfig({config:{transcription:{show:"false"}}})):void 0}),$(document).on("slideChange.subtitle",function(t,i){e.scrolledByScrollTop=!0,e.lastSubIndex="undefined",e.dataSlide=i,e.getSubtitles(i.subtitles),e.containerDom.scrollTop(0),e.subtitleFindDom&&e.subtitleFindDom.val("")}),$(document).on("playerSettingsChange",function(a,n){"boolean"==typeof n.subtitle&&(e.subtitleFlag=!e.subtitleFlag,e.subtitleFlag?e.enableSubtitles():(e.disableSubtitles(),t.is(":visible")&&i.trigger("click")))}),$(document).on("transcript_editmode",function(t,i){i.mode?(setTimeout(function(){EW.ckeditor.init()},300),e.transcriptionEditMode=!0,e.editModeOn()):(e.transcriptionEditMode=!1,e.editModeOff())});var t=$(".presentation_subtitles_search"),i=$(".presentation_subtitles_searchicon");i.on("click",function(){$(this).hasClass("remove_icon")?($(this).removeClass("remove_icon"),t.hide(250),e.containerDom.unhighlight()):($(this).addClass("remove_icon"),t.show(250))}),$("#editTranscript").on("click",function(){}),$(document).on("transcriptEditDialog",function(t,i){$(document).trigger("slidePause"),$(document).trigger("getPlayer",function(t){$(document).trigger("getPresentationJson",function(a){var n={};n.presentation_id=a.presentation_id,n.slide_id=e.dataSlide.slide_id,e.bodyDom||(e.bodyDom=$("body"));var o={};o.data=e.slideMessages,o.player=t,o.trigger=$(i.context),o.remotereference=n,o.callback=$.proxy(e.transcriptRefresh,e),o.slideTitle=e.dataSlide.title,o.slideIndex=e.dataSlide.index,EW["transcription-editor"].openEditor(o),o.data&&$("body").addClass("transcription_editor_enabled")})})}),$(document).on("transcriptEditorClose",function(){e.bodyDom||(e.bodyDom=$("body")),e.bodyDom.removeClass("transcription_editor_enabled")}),this.enableSubtitles()},transcriptRefresh:function(e){var t=this;$(document).trigger("slideChange.subtitle",t.dataSlide)},enableSubtitles:function(){var e=this;$("body").removeClass("transcript_disabled"),this.containerDom.on("click.subtitle",this.subtitleSelector,function(){var e=$(this).attr("data-subtitle-start");$(document).trigger("subtitlesTimeUpdate",parseFloat(e))}),$(document).on("videoTimeUpdate.subtitle",function(t,i){e.subtitleFlag===!0&&e.scrollOnVideoTimeChange(i)}),this.subtitleFindDom||(this.subtitleFindDom=$("#subtitleFind")),this.subtitleFindDom.on("keyup.subtitle",function(){e.highlightedIndex=0,$(document).trigger("slidePause"),e.subtitleFind($(this))}),$(document).on("scrollFoundSubtitles",function(t,i){e.containerDom.scrollTop();e.highlightedItems&&(i.down&&(e.highlightedIndex=e.highlightedIndex===e.highlightedItems.length-1?e.highlightedIndex:++e.highlightedIndex),i.top&&(e.highlightedIndex=0===e.highlightedIndex?e.highlightedIndex:--e.highlightedIndex),e.highlightedItems.removeClass("highlightActive"),e.highlightedItems.eq(e.highlightedIndex).addClass("highlightActive"),e.highlightedItems.eq(e.highlightedIndex)&&e.highlightedItems.eq(e.highlightedIndex)[0]&&e.containerDom.scrollTop(e.highlightedItems.eq(e.highlightedIndex)[0].offsetTop-2),$(document).trigger("subtitlesTimeUpdate",parseFloat(e.highlightedItems.eq(e.highlightedIndex).attr("data-subtitle-start"))))}),$(document).on("subTplAdded",function(e,t){t(function(){})}),$(document).on("getSubtitles",function(t,i){var a=e.slideMessages;i(a)})},disableSubtitles:function(){$("body").addClass("transcript_disabled"),$(document).off("videoTimeUpdate.subtitle scrollsubtitles"),this.containerDom.off("click.subtitle"),$("#subtitleFind").off("keyup.subtitle"),this.containerDom.off("scroll")},scrollOnVideoTimeChange:function(e){if(this.slideMessages&&"object"==typeof this.slideMessages){var t=0;for(t;t<this.slideMessages.length;t++)if(this.slideMessages[t].startTime<=e&&e<=this.slideMessages[t].endTime){var i=this.containerDom.find('[data-subtitle-index="'+this.slideMessages[t].index+'"]');if(i.addClass("txt-color-red bold").siblings().removeClass("txt-color-red bold"),this.slideMessages[t].index!==this.lastSubIndex){i[0].offsetTop?i[0].offsetTop:i.position().top;this.scrolledByScrollTop=!0,this.scrollTopSimulate(i[0].offsetTop-2),this.lastSubIndex=this.slideMessages[t].index}break}}},scrollTopSimulate:function(e){var t=this;this.containerDom.animate({scrollTop:e},200).delay(220).promise().done(function(){t.scrolledByScrollTop=!1})},triggerVideoOnScroll:function(e,t){var i=e.scrollTop();$(document).trigger("slidePause");var a=parseInt(parseFloat(i/e[0].scrollHeight.toPrecision(2))*this.slideMessages.length);a+=3,a=0===a?1:a,a=a>this.slideMessages.length?this.slideMessages.length:a;var e=this.containerDom.find('[data-subtitle-index="'+a+'"]');e.addClass("txt-color-red bold").siblings().removeClass("txt-color-red bold");var n=Math.ceil(parseFloat(e.attr("data-subtitle-start")));$(document).trigger("subtitlesTimeUpdate",n),clearTimeout(this.playDelayTimer),this.playDelayTimer=setTimeout(function(){$(document).trigger("slidePlay")},1200),setTimeout(function(){t()},5)},subtitleFind:function(e){this.containerDom.unhighlight(),this.containerDom.highlight(e.val()),this.highlightedItems=this.containerDom.find(".highlight")},getSubtitles:function(e){var t=this;e.json&&-1!==e.json.indexOf(".json")?$.ajax({url:APP_URL+e.json+"?tmstm="+Math.floor(1e3*Math.random()),success:function(e){try{t.slideMessages=JSON.smartParse(e);var i=0;for(i;i<t.slideMessages.length;i++)t.slideMessages[i].index=i+1;t.templating({messages:t.slideMessages})}catch(a){console.error(a)}},error:function(){t.slideMessages=[]}}):e.vtt&&-1!==e.vtt.indexOf(".vtt")?$.ajax({url:APP_URL+e.vtt+"?tmstm="+Math.floor(1e3*Math.random()),success:function(e){t.parseSubtitles(e)}}):(t.slideMessages="",this.templating({messages:[]}))},parseSubtitles:function(e){var t=this,i=1,a=[],n=new WebVTT.Parser(window,WebVTT.StringDecoder());n.oncue=function(e){var t={};t.text=e.text,e.id&&(t.id=e.id),t.index=i,t.startTime=e.startTime,t.endTime=e.endTime,i+=1,a.push(t)},n.onflush=function(){t.slideMessages=a,t.templating({messages:a})},n.onparsererror=function(){},n.parse(e),n.flush()},templating:function(e){try{var t=this;this.template||(this.template=$.templates(this.templateSelector));var i=this.template.render(e);this.containerDom.off("scroll"),$(document).trigger("subTplAdded",function(e){t.containerDom.html(i),e()})}catch(a){console.error(a)}},editModeOn:function(){var e=this;!this.oldMessages,this.subtContainer.addClass("editmode_transcript"),$(document).on("transcript_editmode_save",function(){e.saveEdit()})},editModeOff:function(){this.subtContainer.removeClass("editmode_transcript"),$(document).off("transcript_editmode_save")},saveEdit:function(e){this.generatePostObj(e,function(e){try{var t=session.GetValue("contentId");$.ajax({url:APP_URL_BACK+"ajxrsp.php?uni="+uniqueid+"&apprcss=editJsonTranscript&cis="+t+"&tmstm="+Math.floor(1e3*Math.random()),type:"POST",dataType:"json",data:e,success:function(){}})}catch(i){console.error(i)}})},generatePostObj:function(e,t){var i=this;$(document).trigger("getPresentationJson",function(a){var n={};n.presentation_id=a.presentation_id,n.slide_id=i.dataSlide.slide_id,e?n.subtitles=e:(console.error("Transcript list is not passed"),n.subtitles=i.slideMessages),t(n)})},itemEdit:function(e){function t(e){for(a;a<i.slideMessages.length;a++){var t=parseInt(e.attr("data-subtitle-index"));a===t-1&&(i.slideMessages[t-1].text=e.text())}}var i=this;$(document).trigger("slidePause"),$(document).trigger("subtitlesTimeUpdate",parseFloat(e.attr("data-subtitle-start"))),""!==e.attr("data-subtitle-index")&&(e.attr({contenteditable:"true","data-element":"object"}),EW.ckeditor.startInlineEditor(e),e.focus()),e.off("focusout.editorr").on("focusout.editorr",function(){EW.ckeditor.destroyInlineEditor($(this)),t($(this))});var a=0}},EW.presentation_author={containerSelector:"#presentationAuthor",templateSelector:"#presentationAuthorTemplate",containerDom:{},dataAuthor:{},authorEditMode:!1,layoutStates:void 0,blockIfEmpty:!1,init:function(){this.handleEvents()},handleEvents:function(){var e=this;return this.containerDom=$(this.containerSelector),EW.presentation_layout_manager.setConfig({fn:function(t){e.layoutStates=t}}),e.layoutStates.logicalStates&&-1===e.layoutStates.logicalStates.indexOf("authorInit")?void console.log("Not initing author (based on config)"):($(document).off("jsonPublished.author").on("jsonPublished.author",function(t,i,a){return!e.layoutStates.logicalStates||-1===e.layoutStates.logicalStates.indexOf("authorNotEmpty")||$.trim(i.author.firstname)||$.trim(i.author.secondname)?(e.dataAuthor=i.author,void e.templating()):(e.blockIfEmpty=!0,void EW.presentation_layout_manager.setConfig({config:{author:{show:"false"}}}))}),$(document).off("author_editmode").on("author_editmode",function(t,i){i.mode?(e.authorEditMode=!0,e.editModeOn()):(e.authorEditMode=!1,e.editModeOff())}),$("#editAuthorSave").off("click").on("click",function(){$(document).trigger("reinit.author")}),void $(document).on("toggleAuthor",function(t,i){e.containerDom.toggle().promise().then(function(){$(document).trigger("resize")})}))},editModeOn:function(){this.containerDom.addClass("editmode_author")},editModeOff:function(){this.containerDom.removeClass("editmode_author")},templating:function(){try{this.template||(this.template=$.templates(this.templateSelector));var e=this.template.render(this.dataAuthor);this.containerDom.html(e)}catch(t){console.error(t)}$(document).trigger("authorTplAdded")}},EW.presentation_resources={allReferencesSelector:"#presentationAllReferences",allReferencesTemplateSelector:"#presentationAllReferencesTemplate",slideReferencesSelector:"#presentationSlideReferences",slideReferencesTemplateSelector:"#presentationSlideReferencesTemplate",referenceSelector:".reference",dataResources:{},activeSlide:{},layoutStates:void 0,blockIfEmpty:!1,init:function(){this.handleEvents()},handleEvents:function(){var e=this;return EW.presentation_layout_manager.setConfig({fn:function(t){e.layoutStates=t}}),e.layoutStates.logicalStates&&-1===e.layoutStates.logicalStates.indexOf("referenceInit")?void console.log("Not initing reference (based on config)"):(this.refContainer=$(e.allReferencesSelector).closest(".jarviswidget"),$(document).on("slideChange",function(t,i){e.activeSlide=e.dataResources&&e.dataResources.slides&&e.dataResources.slides["slide_"+i.index]?e.dataResources.slides["slide_"+i.index]:i;var a="&apprcss=addAssignRa&mode=player&cis="+i.slide_id+"#addAssignRa"+i.slide_id;e.addReferenceDom||(e.addReferenceDom=$("#addReference")),e.addReferenceDom.attr("data-url",a),e.getUserPref(function(){e.templating()})}),$(document).on("jsonPublished.reference",function(t,i,a){return e.layoutStates.logicalStates&&-1!==e.layoutStates.logicalStates.indexOf("referenceNotEmpty")&&!Object.keys(i.references).length?(e.blockIfEmpty=!0,void EW.presentation_layout_manager.setConfig({config:{reference:{show:"false"}}})):(delete e.dataResources,e.dataResources=i,void e.getUserPref(function(){e.templating()}))}),$(document).on("getUserPref",function(t,i){e.getUserPref(function(e){i(e)})}),$(document).on("references_editmode",function(t,i){i.mode?(e.referencesEditMode=!0,e.editModeOn()):(e.referencesEditMode=!1,e.editModeOff())}),this.refContainer.on("click",".editmode_reference_delete",function(t){e.itemEditDelete($(this))}),this.refContainer.on("click",".reference-basket",function(){var e=$(this).attr("date-ned");e&&$(document).trigger("changedReferenceBasket",{id:e,status:!0})}),$(document).on("changedAnnotationBasket",function(t,i){var a='<a href="javascript:void(0);" class="reference-basket disabled" title="Already in the reading basket"><i class="fa fa-bookmark disabled"></i></a>';e.refContainer.find(".reference-basket").each(function(){$(this).attr("date-ned")===i.id&&$(this).replaceWith(a)})}),$("#editReferenceSave").on("click",function(){$(document).trigger("reinit.reference",e.activeSlide)}),void $("#editReferenceEditItem").on("click",function(){$(document).trigger("reinit.reference",e.activeSlide)}))},getUserPref:function(e){var t=this,i={idList:this.referencesIdList()};$.ajax({url:jsonbasket+"&tmstm="+Math.floor(1e3*Math.random()),data:i,type:"POST",dataType:"json",success:function(i){try{var a;for(a in i.references)t.dataResources.references[a]&&"undefined"!=typeof i.references[a]&&"undefined"!=typeof i.references[a].toBasket&&(t.dataResources.references[a].toBasket=i.references[a].toBasket);e&&e(i.references)}catch(n){console.error(n)}},error:function(){}})},referencesIdList:function(){var e,t=[];for(e in this.dataResources.references)t.push(this.dataResources.references[e].id);return t},templating:function(e){try{if(!e){this.slideSubtitlestemplate||(this.slideSubtitlestemplate=$.templates(this.slideReferencesTemplateSelector));var t=this.slideSubtitlestemplate.render(this.slideReferences());$(this.slideReferencesSelector).html(t)}this.allSubtitlestemplate||(this.allSubtitlestemplate=$.templates(this.allReferencesTemplateSelector));var i=this.allSubtitlestemplate.render(this.allRefences());$(this.allReferencesSelector).html(i)}catch(a){console.error(a)}$(document).trigger("resTplAdded")},allRefences:function(){this.allResource={allreferences:[]};for(var e in this.dataResources.references)this.allResource.allreferences.push(this.dataResources.references[e]);return this.allResource},slideReferences:function(){for(var e={slidereferences:[]},t=0;t<this.activeSlide.references.length;t++)e.slidereferences.push(this.dataResources.references["reference_"+this.activeSlide.references[t]]);return e},editModeOn:function(){this.refContainer.addClass("editmode_references"),$(document).on("references_editmode_save",function(){})},editModeOff:function(){this.refContainer.removeClass("editmode_references"),$(document).off("references_editmode_save")},generatePostObj:function(e){var t=this;$(document).trigger("getPresentationJson",function(i){var a={};a.presentation_id=i.presentation_id,a.slide_id=t.activeSlide.slide_id,a.references=t.dataResources,e(a)})},itemEditDelete:function(e){var t=this,i=t.activeSlide.slide_id,a=e.attr("data-reference-id"),n=APP_URL_BACK+"ajxrsp.php?uni="+uniqueid+"&apprcss=DeleteDocModuleRel&cis="+i+"&CID="+a+"&tmstm="+Math.floor(1e3*Math.random());new PNotify({title:"Are you sure you want to remove this assignment?",icon:"fa fa-fw fa-2x fa-question-circle",hide:!1,confirm:{confirm:!0},buttons:{closer:!1,sticker:!1}}).get().on("pnotify.confirm",function(){$.ajax({url:n,success:function(e){$(document).trigger("reinit.reference",t.activeSlide);var i=_success,a="Successfully removed";$(document).trigger("smart-notification",{title:i,content:a,type:"success"})}})}).on("pnotify.cancel",function(){})}},EW.presentation_navigation={containerSelector:"#presentationNavigation",containerSelectorDom:{},templateSelector:"#presentationNavigationTemplate",selectedClass:"navigation_slide_active",modeSelectedBtnClass:"active_nav_mode",listViewModeAttr:"data-view-mode",modeActive:"",imageSelector:".media-object",filterInputSelector:"#filterSlides",filterItemsSelector:".media",presentationDuration:"",dataSlides:{},slideActive:{},videoPlayer:void 0,layoutStates:void 0,blockIfEmpty:!1,init:function(){this.handleEvents()},handleEvents:function(){var e=this;if(EW.presentation_layout_manager.setConfig({fn:function(t){e.layoutStates=t}}),e.layoutStates.logicalStates&&-1===e.layoutStates.logicalStates.indexOf("navigationInit"))return void console.log("Not initing navigation (based on config)");$(document).on("jsonPublished.navigation",function(t,i,a){if(e.layoutStates.logicalStates&&-1!==e.layoutStates.logicalStates.indexOf("navigationNotEmpty")&&0===Object.keys(i.slides).length&&i.slides.constructor===Object)return e.blockIfEmpty=!0,void EW.presentation_layout_manager.setConfig({config:{navigation:{show:"false"}}});if(i.has_virtual_slides===!0&&"undefined"==typeof i.internal_virtual?e.hasVirtualSlides=!0:i.has_virtual_slides===!1&&"undefined"==typeof i.internal_virtual?e.hasVirtualSlides=!1:e.hasVirtualSlidesInternal=!0,e.hasVirtualSlidesInternal?(e.parentSlide=i.slides.slide_1,e.slideActive=e.parentSlide,e.dataSlides=i.virtual_slides,e.virtualModeParentSlideEdit()):e.dataSlides=i.slides,i.durationCalculated&&0!=i.durationCalculated)e.presentationDuration=i.durationCalculated.toHHMMSS(!1,!0);else{var n="0";e.presentationDuration=n.toHHMMSS(!1,!0),e.hasVirtualSlidesInternal||e.hasVirtualSlides?$(document).on("loadedMetadata",function(t,i){e.videoPlayer||(e.videoPlayer=i),n=e.videoPlayer.duration()+""||"0",e.presentationDuration=n.toHHMMSS(!1,!0),EW.presentation_player.slideStatus(!0)}):console.error("Caught => durationCalculated is required in presentation with slides")}e.filterSlides(),e.templating()}),$(document).on("videoPlayerInited",function(t,i){(e.hasVirtualSlides||e.hasVirtualSlidesInternal)&&$(document).trigger("virtualSlideChange.navigation",e.dataSlides.slide_1)}),$(document).on("slideChange",function(t,i){e.hasVirtualSlides===!1&&(e.slideActive=i,e.changeSelectedClass(i),e.changeViewMode())});var t;$(document).on("videoTimeUpdate",function(i,a){if(e.hasVirtualSlides||e.hasVirtualSlidesInternal){var n;for(n in e.dataSlides)a>=e.dataSlides[n].start_time&&a<=e.dataSlides[n].end_time&&n!==t&&($(document).trigger("virtualSlideChange.navigation",e.dataSlides[n]),t=n)}}),$(document).on("virtualSlideChange.navigation",function(t,i){(0!==Object.keys(e.dataSlides).length||e.dataSlides.constructor!==Object)&&(e.changeSelectedClass(i),e.slidePosition(g,i),(e.hasVirtualSlides||e.hasVirtualSlidesInternal)&&(s=i.start_time))}),this.containerSelectorDom=$(this.containerSelector),this.containerSelectorDom.on("click",".media",function(){e.dontScrollOnClick=!0;var t=$(this).attr("data-slide-index");e.dataSlides["slide_"+t]&&(e.hasVirtualSlides===!1?$(document).trigger("slideChange",e.dataSlides["slide_"+t]):$(document).trigger("virtualSlideChange",e.dataSlides["slide_"+t]),setTimeout(function(){e.dontScrollOnClick=!1},100))}),this.containerSelectorDom.on("click",".editmode_navigation_item",function(t){e.navigationEditMode&&e.itemEdit($(this).closest("li").find(".media"))});var i=$("#navigationSlideStatus"),a=i.find(".progress-nr"),n="",o="",s=0,r="";this.elColl||(this.elColl=$(".presentation_navigation_container .el-coll")),$(document).on("slideChangeStatus",function(t,l){if(clearInterval(d),l.currentNr&&l.allNr){i.find(".progress-bar").css("width",l.currentNr/l.allNr*100+"%"),e.hasVirtualSlides||e.hasVirtualSlidesInternal?(e.videoPlayer||$(document).trigger("getPlayer",function(t){e.videoPlayer=t}),s=e.videoPlayer.currentTime()):s=e.generateTime(s);var c=l.currentNr/l.allNr;r=getColorForPercentage(c),o=n="<span class='progress-nr-left' title='Passed duration'>"+(s+"").toHHMMSS(!1,!0)+"</span>",n="<span class='progress-nr-center' title='Slides progress'>"+l.currentNr+" / "+l.allNr+"</span>",n+="<span class='progress-nr-right' style='color:"+r+"' title='Total duration'>"+e.presentationDuration+"</span>",a.html(o+n),l.isFirst===!0?(e.elColl.attr("el-state","initCL"),EW["handle-preview-layout"].init()):l.isLast===!0?(e.elColl.attr("el-state","lastCL"),EW["handle-preview-layout"].init()):l.isBetween===!0&&(e.elColl.attr("el-state","runnCL"),EW["handle-preview-layout"].init())}});var l=new Date;$(document).on("videoTimeUpdate",function(t,i){if(new Date-l>100){var r=parseInt(s+i)+"";(e.hasVirtualSlides||e.hasVirtualSlidesInternal)&&(s=i,r=s+""),0===i&&(r=e.generateTime(i)+""||0),r=r.toHHMMSS(!1,!0),o="<span class='progress-nr-left' title='Passed duration' >"+r+"</span>",a.html(o+n),l=new Date}});var d;$(document).on("timechangemanually",function(e,t){var i=(t.lefttime,t.pasttime+1);clearInterval(d),d=setInterval(function(){$(document).trigger("videoTimeUpdate.subtitle",parseInt(i));var e=parseInt(s+i)+"";e=e.toHHMMSS(),o="<span class='progress-nr-left' title='Passed duration' >"+e+"</span>",a.html(o+n),l=new Date,i+=1,t.lefttime<i&&clearInterval(d)},1e3)}),$("["+this.listViewModeAttr+"]").on("click",function(t){e.modeActive=$(this).attr(e.listViewModeAttr),e.changeViewMode($(this)),t.preventDefault()});var c,u=!1;$(document).on("showFilter",function(e,t){u=!u,c||(c=$("#filterSlidesContainer")),u?c.removeClass("filter_slides_hide"):c.addClass("filter_slides_hide"),u||c.find("#filterSlides").val("").keyup()});var g=$(".navigation_list .widget-body");$(document).on("slideChange",function(t,i){e.dontScrollOnClick||e.slidePosition(g,i)}),$(document).on("navigation_editmode",function(t,i){i.mode?(e.navigationEditMode=!0,e.editModeOn()):(this.navigationEditMode=!1,e.editModeOff())}),$("#editNavigationSave").on("click",function(t){$(document).trigger("reinit.navigation",e.slideActive)}),$(document).on("navTplAdded",function(){e.containerSelectorDom.find("img").each(function(e){var t=this;setTimeout(function(){$(t).attr("src",$(t).attr("data-src")+APP_UNI+"&stamp="+(new Date).getTime())},120*e)})});var f,h=$("#navigationList").parents(".presentation_separate_virtualslides").length?110:74,m=0,p=3*h;$(document).on("navigationHorizontal",function(t,i){f||(f=$("#navigationList").find(".widget-body").eq(0)),i.left&&(m=m>=p?m-p:0),i.right&&(m=m<e.containerSelectorDom.width()-f.width()-p?m+p:e.containerSelectorDom.width()-f.width()+60),f.animate({scrollLeft:m},200)})},slidePosition:function(e,t){$(document).trigger("isDesktop",function(i){var a=$("li[data-slide-index='"+t.index+"']"),n=a.position().top,o=a.position().left,s=a.outerHeight(),r=a.outerWidth(),l=e.outerHeight(),d=e.outerWidth();i?e.scrollTop(n-(l/2-s/2)):e.scrollLeft(o-(d/2-r/2))})},changeViewMode:function(e){e&&e.addClass(this.modeSelectedBtnClass).siblings().removeClass(this.modeSelectedBtnClass),this.hasVirtualSlides||("nothumb"===this.modeActive?this.containerSelectorDom.addClass("nothumb_mode"):this.containerSelectorDom.removeClass("nothumb_mode"))},templating:function(){try{this.template||(this.template=$.templates(this.templateSelector));var e=this.template.render(this.allSlides());this.containerSelectorDom.html(e)}catch(t){console.error(t)}$(document).trigger("navTplAdded")},changeSelectedClass:function(e){$('li[data-slide-index="'+e.index+'"]').addClass(this.selectedClass).siblings().removeClass(this.selectedClass)},filterSlides:function(){var e=this;jQuery.expr[":"].icontains=function(e,t,i){return jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())>=0},$(this.filterInputSelector).on("keyup",function(){var t=this.value,i=e.containerSelectorDom.find("li");return""===this.value?void i.show():(i.hide(),void i.filter(function(e,i){var a=$(this);return a.is(":icontains('"+t+"')")?!0:!1}).show())}).focus(function(){this.value="",$(this).unbind("focus")})},allSlides:function(){var e={slides:[]};for(var t in this.dataSlides){this.dataSlides[t].rand=(new Date).getTime();var i=this.slideConfigCheck(this.dataSlides[t]);e.slides.push(i)}return e},slideConfigCheck:function(e){return e.small_img&&-1===e.small_img.indexOf("http")&&(e.small_img=APP_URL+e.small_img),!$.trim(e.small_img)&&presentationConfig.navigation.extra.slideThumbnail&&-1!==presentationConfig.navigation.extra.slideThumbnail.indexOf("http")&&(e.small_img=presentationConfig.navigation.extra.slideThumbnail),e},editModeOn:function(){this.containerSelectorDom.closest(".jarviswidget").addClass("editmode_navigation")},editModeOff:function(){this.containerSelectorDom.closest(".jarviswidget").removeClass("editmode_navigation")},itemEdit:function(e){var t=e.attr("data-slide-index"),i=this.dataSlides["slide_"+t];this.slideActive=i},virtualModeParentSlideEdit:function(){var e=$(".editmode_navigation_item");if(e.length){var t=e.attr("data-url"),i=t.replace(/\{slide_id\}/g,this.parentSlide.slide_id);e.attr("data-url",i)}},slideEditSave:function(){},generateTime:function(e){var t=0;if(this.hasVirtualSlides)t=e;else{for(var i in this.dataSlides)this.dataSlides[i]&&this.dataSlides[i].index<this.slideActive.index&&(this.dataSlides[i].durationCalculated&&(t+=parseFloat(this.dataSlides[i].durationCalculated)),this.dataSlides[i].durationExtra&&(t+=parseFloat(this.dataSlides[i].durationExtra)))}return t}},EW.presentation_editmode={activeSlide:{},slideId:0,editMode:!1,timelineDuration:0,tabs:{subtitles:!0,annotations:!1},init:function(){this.handleEvents()},handleEvents:function(){var e=this,t=$("body");$(document).on("playerSettingsChange",function(t,i){"boolean"==typeof i.editmodeplayer&&(e.editMode=i.editmodeplayer,$(document).trigger("slidePause"),$(document).trigger("player_editmode",{mode:e.editMode}),$(document).trigger("transcript_editmode",{mode:e.editMode}),$(document).trigger("author_editmode",{mode:e.editMode}),$(document).trigger("references_editmode",{mode:e.editMode}),$(document).trigger("navigation_editmode",{mode:e.editMode}),$(document).trigger("annotationsEdit",{mode:e.editMode}))}),$(document).on("videoDuration",function(t,i){e.timelineDuration=parseInt(i)}),$(document).on("editmode_timeline",function(t,i){i&&i.subtitles?(e.tabs.subtitles=!0,e.tabs.annotations=!1):(e.tabs.annotations=!0,e.tabs.subtitles=!1),e.tabChange()}),t.on("click.zoom",".timelinezoom",function(){$(this).attr("data-zoom");e.tabs.subtitles||e.tabs.annotations})},getTimelineDependensies:function(e){"undefined"==typeof vis?$.getScript(APP_URL+"include_js/vis_js/vis.min.js",function(){e()}):e()},timelineChange:function(){this.tabs.subtitles===!0?this.subtitlesVideoTimeline():this.annotationVideoTimeline()},tabChange:function(){this.tabs.subtitles===!0?this.subtitlesVideoTimeline():this.annotationVideoTimeline()},subtitlesVideoTimeline:function(e){var t=new vis.DataSet(this.genSubtitleData());if(this.subtitleTimelineContainer)this.subtimeline.setItems(t);else{this.subtitleTimelineContainer=document.getElementById("subtitlesTimeline");var i={editable:!0,min:0,max:this.timelineDuration+10};this.subtimeline=new vis.Timeline(this.subtitleTimelineContainer,t,i),this.subtimeline.on("rangechange",function(e){}),this.subtimeline.on("rangechanged",function(e){}),this.subtimeline.on("select",function(){}),this.subtimeline.on("click",function(e,t){})}},annotationVideoTimeline:function(e){var t=new vis.DataSet(this.genAnnottationData());if(this.annotationTimelineContainer)this.annotimeline.setItems(t);else{this.annotationTimelineContainer=document.getElementById("annotationsTimeline");var i={editable:!0,min:0,max:this.timelineDuration+10};this.annotimeline=new vis.Timeline(this.annotationTimelineContainer,t,i),this.annotimeline.on("rangechange",function(e){}),this.annotimeline.on("rangechanged",function(e){}),this.annotimeline.on("select",function(e){}),this.annotimeline.on("onRemove",function(){}),this.annotimeline.on("click",function(e,t){})}},genSubtitleData:function(){for(var e=EW.presentation_subtitles.slideMessages,t=[],i=0;i<e.length;i++){var a={};e[i].id&&(a.id=e[i].id),e[i].text&&(a.content=e[i].text),e[i].startTime&&(a.start=e[i].startTime),e[i].endTime&&(a.end=e[i].endTime),t.push(a)}return t},genAnnottationData:function(){for(var e=EW.presentation_annotations.slideAnnotations,t=[],i=0;i<e.length;i++){var a={};e[i].id&&(a.id=e[i].id),e[i].text&&(a.content=e[i].text),e[i].startTime&&(a.start=e[i].startTime),e[i].endTime&&(a.end=e[i].endTime),t.push(a)}return t},annotationListByTime:function(e){}},EW.presentation_layout_manager={removeRightClass:"presentation_noright_column",bodyDom:void 0,presentationDom:void 0,preferencesDom:void 0,init:function(){this.handleEvents()},handleEvents:function(){var e=this;this.bodyDom=$("body"),this.presentationDom=$("#presentation"),this.preferencesDom=$("#presentationPlayerSettings"),$(document).on("layoutChange",function(t,i){i.rightpanel===!1?(e.bodyDom.addClass(e.removeRightClass),e.toggleSearch(!1)):(e.bodyDom.removeClass(e.removeRightClass),$(document).trigger("resize"),e.toggleSearch(!0))}),$(document).on("playerPreferencesChange",function(){}),this.preferencesDom.on("change","#preferenceTranscript",function(){this.checked?e.config.transcription.visibility="visible":e.config.transcription.visibility="invisible",e.setStates()}),this.preferencesDom.on("change","#preferenceAnnotations",function(){this.checked?e.config.annotations.visibility="visible":e.config.annotations.visibility="invisible",e.setStates()}),this.preferencesDom.on("change","#preferenceRelatedPanel",function(){this.checked?e.config.rightcolumn.visibility="visible":e.config.rightcolumn.visibility="invisible",e.setStates()}),this.preferencesDom.on("change","#preferenceAuthor",function(){this.checked?e.config.author.visibility="visible":e.config.author.visibility="invisible",e.setStates()}),this.preferencesDom.on("change","#preferenceReference",function(){this.checked?e.config.reference.visibility="visible":e.config.reference.visibility="invisible",e.setStates()}),this.preferencesDom.on("change","#preferenceNavigation",function(){this.checked?e.config.navigation.visibility="visible":e.config.navigation.visibility="invisible",e.setStates()})},disablePreferenceCheckbox:function(e){var t={author:"#preferenceAuthor",reference:"#preferenceReference",navigation:"#preferenceNavigation",transcription:"#preferenceTranscript",annotations:"#preferenceAnnotations"};$(t[e]).attr("disabled","disabled").closest(".toggle").addClass("state-disabled")},toggleSearch:function(e){var t=this;$(document).trigger("isDesktop",function(i){i||(t.controlbarSearchDom||(t.controlbarSearchDom=$(".vjs-searchslides-button")),e?t.controlbarSearchDom.removeClass("disabled"):t.controlbarSearchDom.addClass("disabled"))})},config:void 0,setConfig:function(e){if(this.config||(this.config={author:{show:"",visibility:"",extra:{photo:"",affiliation:"",country:""}},reference:{show:"",visibility:"",extra:{showSlideReferences:""}},navigation:{show:"",visibility:"",extra:{showTitle:"",showThumbnail:"",showDescription:"",showIndex:"",slideThumbnail:""}},player:{view:"",extra:{coverImage:""}},transcription:{show:"",visibility:""
},annotations:{show:""},rightcolumn:{visibility:""}}),$.extend(!0,this.config,e.config||presentationConfig),e.config)for(var t in e.config)this.disablePreferenceCheckbox(t);this.setStates(e.fn)},getConfig:function(){return this.config},states:{logicalStates:{authorInit:function(){var e=!1;return("true"==this.config.author.show||"ifnotempty"==this.config.author.show)&&(e=!0),e},referenceInit:function(){var e=!1;return("true"==this.config.reference.show||"ifnotempty"==this.config.reference.show)&&(e=!0),e},referenceSlideInit:function(){var e=!1;return"true"==this.config.reference.extra.showSlideReferences&&(e=!0),e},navigationInit:function(){var e=!1;return("true"==this.config.navigation.show||"ifnotempty"==this.config.navigation.show)&&(e=!0),e},transcriptionInit:function(){var e=!1;return("true"==this.config.transcription.show||"ifnotempty"==this.config.transcription.show)&&(e=!0),e},annotationInit:function(){var e=!1;return("true"==this.config.transcription.show||"ifnotempty"==this.config.transcription.show)&&(e=!0),e},coverImg:function(){var e=!1;return e},slideImg:function(){var e=!1;return e},authorNotEmpty:function(){var e=!1;return"ifnotempty"==this.config.author.show&&(e=!0),e},referenceNotEmpty:function(){var e=!1;return"ifnotempty"==this.config.reference.show&&(e=!0),e},navigationNotEmpty:function(){var e=!1;return"ifnotempty"==this.config.navigation.show&&(e=!0),e},transcriptionNotEmpty:function(){var e=!1;return"ifnotempty"==this.config.transcription.show&&(e=!0),e},annotationNotEmpty:function(){var e=!1;return"ifnotempty"==this.config.annotations.show&&(e=!0),e}},visualStates:{"presentation-fullwidth":function(){var e=!1;return"fullwidth"==this.config.player.view&&(e=!0),e},"no-right-column":function(){var e=!1;return"invisible"!=this.config.rightcolumn.visibility&&("false"!=this.config.author.show&&"invisible"!=this.config.author.visibility||"false"!=this.config.reference.show&&"invisible"!=this.config.reference.visibility||"false"!=this.config.navigation.show&&"invisible"!=this.config.navigation.visibility)||(e=!0),e},"no-author-block":function(){var e=!1;return("false"==this.config.author.show||"invisible"==this.config.author.visibility)&&(e=!0),e},"no-annotation":function(){var e=!1;return("false"==this.config.annotations.show||"invisible"==this.config.annotations.visibility)&&(e=!0),e},"no-author-photo":function(){var e=!1;return"false"==this.config.author.extra.photo&&(e=!0),e},"no-author-affiliation":function(){var e=!1;return"false"==this.config.author.extra.affiliation&&(e=!0),e},"no-author-country":function(){var e=!1;return"false"==this.config.author.extra.country&&(e=!0),e},"no-reference-block":function(){var e=!1;return("false"==this.config.reference.show||"invisible"==this.config.reference.visibility)&&(e=!0),e},"no-reference-slide":function(){var e=!1;return"true"!=this.config.reference.extra.showSlideReferences&&(e=!0),e},"no-navigation-block":function(){var e=!1;return("false"==this.config.navigation.show||"invisible"==this.config.navigation.visibility)&&(e=!0),e},"no-navigation-title":function(){var e=!1;if("true"!=this.config.navigation.extra.showTitle)var e=!0;return e},"no-navigation-thumbnail":function(){var e=!1;if("true"!=this.config.navigation.extra.showThumbnail)var e=!0;return e},"no-navigation-description":function(){var e=!1;if("true"!=this.config.navigation.extra.showDescription)var e=!0;return e},"no-navigation-index":function(){var e=!1;if("true"!=this.config.navigation.extra.showIndex)var e=!0;return e},"no-transcription-block":function(){var e=!1;return("false"==this.config.transcription.show||"invisible"==this.config.transcription.visibility)&&(e=!0),e}}},statesActive:{logicalStates:[],visualStates:[]},setStates:function(e){this.presentationDom||(this.presentationDom=$("#presentation")),this.statesActive.logicalStates=[],this.statesActive.visualStates=[],$.each(this.states.visualStates,function(e,t){t.call(this)&&this.statesActive.visualStates.push(e)}.bind(this)),$.each(this.states.logicalStates,function(e,t){t.call(this)&&this.statesActive.logicalStates.push(e)}.bind(this)),$.each(this.states.visualStates,function(e,t){this.presentationDom.removeClass(e)}.bind(this)),$.each(this.statesActive.visualStates,function(e,t){this.presentationDom.addClass(t)}.bind(this)),e&&e(this.statesActive),$(document).trigger("layoutManagerReady",this.statesActive)}},EW.presentation_general={init:function(){this.handleEvents()},handleEvents:function(){var e=$("#presentation"),t={};t.context=e,t.dir1="down",t.dir2="left";var i="Success",a="Success",n="fa fa-check",o="#739E73",s="success";$(document).on("smart-notification",function(e,r){s="success","undefined"!=typeof r.title&&(i=r.title),"undefined"!=typeof r.content&&(a=r.content),r.icon&&(n=r.icon),r.color&&(o=r.color),r.type&&(s=r.type),new PNotify({title:i,text:a,type:s,stack:t,delay:1e3,buttons:{sticker:!1}})}),$(document).on("slidesSearchMobile",function(){e.toggleClass("filter_slides_show_mob")}),$(document).on("disableSearch",function(t,i){e.hasClass("search_disabled")?(e.removeClass("search_disabled"),e.removeClass("filter_slides_show_mob")):e.addClass("search_disabled")});var r=!1,l=$("#toggle-edit-mode");$(document).on("videoTplAdded",function(){var e=l.is(":checked");l.length&&e?(r=!0,$(document).trigger("playerSettingsChange",{editmodeplayer:e})):"undefined"!=typeof authorEditModeFlag&&authorEditModeFlag===!0?(r=!0,$(document).trigger("playerSettingsChange",{editmodeplayer:r})):r=!1}),$(document).on("videoTplAdded subTplAdded authorTplAdded resTplAdded navTplAdded",function(){var t=l.is(":checked");if(t&&EW["toggle-edit-mode"])try{EW["toggle-edit-mode"].showEdit(e)}catch(i){console.error(i)}}),l.on("change",function(){if(e.is(":visible")){$(document).trigger("playerSettingsChange",{editmodeplayer:this.checked});var t=l.is(":checked");t&&EW["toggle-edit-mode"].showEdit(e)}})}},EW.presentation_track={template:void 0,templateContainerDom:void 0,templateContainerSelector:"#trackableContainer",templateSelector:"#trackableTemplate",activeSlideId:void 0,init:function(){var e=this;$(document).on("jsonPublished",function(t,i){i.slides.slide_1.trackable_code&&(e.templating(i.slides.slide_1.trackable_code),e.activeSlideId=i.slides.slide_1.slide_id)}),$(document).on("slideChange",function(t,i){e.activeSlideId&&EW.analytics&&EW.analytics.trigger("close",e.activeSlideId),i.trackable_code&&(e.templating(i.trackable_code),e.activeSlideId=i.slide_id)})},templating:function(e){this.template||(this.template=$.templates(this.templateSelector)),this.templateContainerDom||(this.templateContainerDom=$(this.templateContainerSelector));var t=this.template.render({trackable_code:e});this.templateContainerDom.html(t)}};
//# sourceMappingURL=lecture-player.min.js